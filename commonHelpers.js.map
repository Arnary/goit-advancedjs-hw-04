{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = \"44432226-c2b8db609e5d1d7f1a74c07d6\";\n\nconst BASIC_URL = \"https://pixabay.com/api/\";\n\nexport async function getPhoto(query, page, per_page=40) {\n    const response = await axios.get(BASIC_URL, {\n        params: {\n            key: API_KEY,\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page,\n        }\n    });\n\n    if (response.status != 200) {\n        throw new Error(response.statusText);\n    };\n\n    return response.data;\n}\n","import iziToast from \"izitoast\";\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { getPhoto } from \"./pixabay-api\";\n\nconst form = document.querySelector(\".search-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst guard = document.querySelector(\".js-guard\");\n\nform.addEventListener(\"input\", (event) => {query = event.target.value;});\nform.addEventListener(\"submit\", handlerSubmit);\n\nlet page = 1;\nlet query;\nlet options = {\n    root: null,\n    rootMargin: \"300px\",\n};\n\nconst observer = new IntersectionObserver(handlerLoadMore, options);\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\nfunction handlerSubmit(event) {\n    event.preventDefault();\n    observer.unobserve(guard);\n    page = 1;\n\n    getPhoto(query, page).then((data) => {\n      if (data.totalHits === 0) {\n            gallery.innerHTML = \"\";\n            \n            iziToast.error({\n            position: \"topRight\",\n            message: \"Sorry, there are no images matching your search query. Please try again.\",\n            backgroundColor: \"rgb(245, 156, 22)\",\n            maxWidth: \"400px\",\n            timeout: 3000,\n            messageColor: \"black\",\n            });\n            return;\n      };\n\n      iziToast.success({\n          position: \"topRight\",\n          message: `Hooray! We found ${data.totalHits} images.`,\n          timeout: 2000,\n          messageColor: \"black\",\n      });\n\n      gallery.innerHTML = createGallery(data.hits);\n      \n      lightbox.refresh();\n      \n      window.scrollTo(0,0);\n\n      observer.observe(guard);\n    }).catch((err) => {\n        console.log(err);\n    });\n};\n\nfunction createGallery(arr) {\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => \n        `<div class=\"photo-card\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes</b>\n            ${likes}\n          </p>\n          <p class=\"info-item\">\n            <b>Views</b>\n            ${views}\n          </p>\n          <p class=\"info-item\">\n            <b>Comments</b>\n            ${comments}\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads</b>\n            ${downloads}\n          </p>\n        </div>\n      </div>`\n\n    ).join(\"\")\n};\n\nfunction handlerLoadMore(entries) {\n  entries.forEach((entry) => {\n    if (entry.isIntersecting) {\n      page += 1;\n\n        getPhoto(query, page).then((data) => {\n          gallery.insertAdjacentHTML(\n              \"beforeend\",\n              createGallery(data.hits)\n            );\n            \n          lightbox.refresh();\n          \n          if (page*40 >= data.totalHits) {\n            iziToast.info({\n                position: \"bottomCenter\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n                messageColor: \"black\",\n            });\n            observer.unobserve(guard);\n          };\n        });\n      };\n  });\n};\n"],"names":["API_KEY","BASIC_URL","getPhoto","query","page","per_page","response","axios","form","gallery","guard","event","handlerSubmit","options","observer","handlerLoadMore","lightbox","SimpleLightbox","data","iziToast","createGallery","err","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","entries","entry"],"mappings":"owBAEA,MAAMA,EAAU,qCAEVC,EAAY,2BAEX,eAAeC,EAASC,EAAOC,EAAMC,EAAS,GAAI,CACrD,MAAMC,EAAW,MAAMC,EAAM,IAAIN,EAAW,CACxC,OAAQ,CACJ,IAAKD,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAAC,CACH,CACT,CAAK,EAED,GAAIC,EAAS,QAAU,IACnB,MAAM,IAAI,MAAMA,EAAS,UAAU,EAGvC,OAAOA,EAAS,IACpB,CCjBA,MAAME,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAQ,SAAS,cAAc,WAAW,EAEhDF,EAAK,iBAAiB,QAAUG,GAAU,CAACR,EAAQQ,EAAM,OAAO,KAAM,CAAC,EACvEH,EAAK,iBAAiB,SAAUI,CAAa,EAE7C,IAAIR,EAAO,EACPD,EACAU,EAAU,CACV,KAAM,KACN,WAAY,OAChB,EAEA,MAAMC,EAAW,IAAI,qBAAqBC,EAAiBF,CAAO,EAE5DG,EAAW,IAAIC,EAAe,YAAY,EAEhD,SAASL,EAAcD,EAAO,CAC1BA,EAAM,eAAc,EACpBG,EAAS,UAAUJ,CAAK,EACxBN,EAAO,EAEPF,EAASC,EAAOC,CAAI,EAAE,KAAMc,GAAS,CACnC,GAAIA,EAAK,YAAc,EAAG,CACpBT,EAAQ,UAAY,GAEpBU,EAAS,MAAM,CACf,SAAU,WACV,QAAS,2EACT,gBAAiB,oBACjB,SAAU,QACV,QAAS,IACT,aAAc,OAC1B,CAAa,EACD,MAEZ,CACMA,EAAS,QAAQ,CACb,SAAU,WACV,QAAS,oBAAoBD,EAAK,SAAS,WAC3C,QAAS,IACT,aAAc,OACxB,CAAO,EAEDT,EAAQ,UAAYW,EAAcF,EAAK,IAAI,EAE3CF,EAAS,QAAO,EAEhB,OAAO,SAAS,EAAE,CAAC,EAEnBF,EAAS,QAAQJ,CAAK,CAC5B,CAAK,EAAE,MAAOW,GAAQ,CACd,QAAQ,IAAIA,CAAG,CACvB,CAAK,CACL,CAEA,SAASD,EAAcE,EAAK,CACxB,OAAOA,EAAI,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IACpF;AAAA,wCACgCL,CAAa;AAAA,oBACjCD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,cAKhCC,CAAK;AAAA;AAAA;AAAA;AAAA,cAILC,CAAK;AAAA;AAAA;AAAA;AAAA,cAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,cAIRC,CAAS;AAAA;AAAA;AAAA,aAKvB,EAAM,KAAK,EAAE,CACb,CAEA,SAASd,EAAgBe,EAAS,CAChCA,EAAQ,QAASC,GAAU,CACrBA,EAAM,iBACR3B,GAAQ,EAENF,EAASC,EAAOC,CAAI,EAAE,KAAMc,GAAS,CACnCT,EAAQ,mBACJ,YACAW,EAAcF,EAAK,IAAI,CACrC,EAEUF,EAAS,QAAO,EAEZZ,EAAK,IAAMc,EAAK,YAClBC,EAAS,KAAK,CACV,SAAU,eACV,QAAS,6DACT,aAAc,OAC9B,CAAa,EACDL,EAAS,UAAUJ,CAAK,EAEpC,CAAS,EAET,CAAG,CACH"}