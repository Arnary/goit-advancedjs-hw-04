{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = \"44432226-c2b8db609e5d1d7f1a74c07d6\";\n\nconst BASIC_URL = \"https://pixabay.com/api/\";\n\nexport async function getPhoto(query, page, per_page=40) {\n    const response = await axios.get(BASIC_URL, {\n        params: {\n            key: API_KEY,\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page,\n        }\n    });\n\n    if (response.status != 200) {\n        throw new Error(response.statusText);\n    };\n\n    return response.data;\n}\n","import iziToast from \"izitoast\";\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { getPhoto } from \"./pixabay-api\";\n\nconst form = document.querySelector(\".search-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst guard = document.querySelector(\".js-guard\");\n\nform.addEventListener(\"input\", (event) => {query = event.target.value.trim();});\nform.addEventListener(\"submit\", handlerSubmit);\n\nlet page = 1;\nlet query;\nlet options = {\n    root: null,\n    rootMargin: \"300px\",\n};\n\nconst observer = new IntersectionObserver(handlerLoadMore, options);\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\nfunction handlerSubmit(event) {\n  event.preventDefault();\n  observer.unobserve(guard);\n  page = 1;\n\n  if (!query) {\n    gallery.innerHTML = \"\";\n    iziToast.info({\n      position: \"topRight\",\n      message: \"You should enter a query in the search field.\",\n      maxWidth: \"400px\",\n      timeout: 2000,\n      messageColor: \"black\",\n    });\n    return;\n  }; \n\n  getPhoto(query, page).then((data) => { \n    if (data.totalHits === 0) {\n      gallery.innerHTML = \"\";\n      iziToast.error({\n        position: \"topRight\",\n        message: \"Sorry, there are no images matching your search query. Please try again.\",\n        backgroundColor: \"rgb(245, 156, 22)\",\n        maxWidth: \"400px\",\n        timeout: 3000,\n        messageColor: \"black\",\n      });\n      return;\n    };\n\n    iziToast.success({\n        position: \"topRight\",\n        message: `Hooray! We found ${data.totalHits} images.`,\n        timeout: 2000,\n        messageColor: \"black\",\n    });\n\n    gallery.innerHTML = createGallery(data.hits);\n    \n    lightbox.refresh();\n    \n    window.scrollTo(0, 0);\n    \n    observer.observe(guard);\n\n    if (page*40 >= data.totalHits) {\n      iziToast.info({\n          position: \"bottomCenter\",\n          message: \"We're sorry, but you've reached the end of search results.\",\n          messageColor: \"black\",\n      });\n      observer.unobserve(guard);\n    };\n  }).catch((err) => {\n        console.log(err);\n    });\n};\n\nfunction createGallery(arr) {\n  return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n    `<div class=\"photo-card\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n      <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n      </a>\n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes</b>\n          ${likes}\n        </p>\n        <p class=\"info-item\">\n          <b>Views</b>\n          ${views}\n        </p>\n        <p class=\"info-item\">\n          <b>Comments</b>\n          ${comments}\n        </p>\n        <p class=\"info-item\">\n          <b>Downloads</b>\n          ${downloads}\n        </p>\n      </div>\n    </div>`\n  ).join(\"\");\n};\n\nfunction handlerLoadMore(entries) {\n  entries.forEach((entry) => {\n    if (entry.isIntersecting) {\n      page += 1;\n\n        getPhoto(query, page).then((data) => {\n          gallery.insertAdjacentHTML(\n              \"beforeend\",\n              createGallery(data.hits)\n            );\n            \n          lightbox.refresh();\n          \n          if (page*40 >= data.totalHits) {\n            iziToast.info({\n                position: \"bottomCenter\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n                messageColor: \"black\",\n            });\n            observer.unobserve(guard);\n          };\n        });\n      };\n  });\n};\n"],"names":["API_KEY","BASIC_URL","getPhoto","query","page","per_page","response","axios","form","gallery","guard","event","handlerSubmit","options","observer","handlerLoadMore","lightbox","SimpleLightbox","iziToast","data","createGallery","err","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","entries","entry"],"mappings":"owBAEA,MAAMA,EAAU,qCAEVC,EAAY,2BAEX,eAAeC,EAASC,EAAOC,EAAMC,EAAS,GAAI,CACrD,MAAMC,EAAW,MAAMC,EAAM,IAAIN,EAAW,CACxC,OAAQ,CACJ,IAAKD,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAAC,CACH,CACT,CAAK,EAED,GAAIC,EAAS,QAAU,IACnB,MAAM,IAAI,MAAMA,EAAS,UAAU,EAGvC,OAAOA,EAAS,IACpB,CCjBA,MAAME,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAQ,SAAS,cAAc,WAAW,EAEhDF,EAAK,iBAAiB,QAAUG,GAAU,CAACR,EAAQQ,EAAM,OAAO,MAAM,KAAM,CAAC,CAAC,EAC9EH,EAAK,iBAAiB,SAAUI,CAAa,EAE7C,IAAIR,EAAO,EACPD,EACAU,EAAU,CACV,KAAM,KACN,WAAY,OAChB,EAEA,MAAMC,EAAW,IAAI,qBAAqBC,EAAiBF,CAAO,EAE5DG,EAAW,IAAIC,EAAe,YAAY,EAEhD,SAASL,EAAcD,EAAO,CAK5B,GAJAA,EAAM,eAAc,EACpBG,EAAS,UAAUJ,CAAK,EACxBN,EAAO,EAEH,CAACD,EAAO,CACVM,EAAQ,UAAY,GACpBS,EAAS,KAAK,CACZ,SAAU,WACV,QAAS,gDACT,SAAU,QACV,QAAS,IACT,aAAc,OACpB,CAAK,EACD,MAEJ,CACEhB,EAASC,EAAOC,CAAI,EAAE,KAAMe,GAAS,CACnC,GAAIA,EAAK,YAAc,EAAG,CACxBV,EAAQ,UAAY,GACpBS,EAAS,MAAM,CACb,SAAU,WACV,QAAS,2EACT,gBAAiB,oBACjB,SAAU,QACV,QAAS,IACT,aAAc,OACtB,CAAO,EACD,MAEN,CACIA,EAAS,QAAQ,CACb,SAAU,WACV,QAAS,oBAAoBC,EAAK,SAAS,WAC3C,QAAS,IACT,aAAc,OACtB,CAAK,EAEDV,EAAQ,UAAYW,EAAcD,EAAK,IAAI,EAE3CH,EAAS,QAAO,EAEhB,OAAO,SAAS,EAAG,CAAC,EAEpBF,EAAS,QAAQJ,CAAK,EAElBN,EAAK,IAAMe,EAAK,YAClBD,EAAS,KAAK,CACV,SAAU,eACV,QAAS,6DACT,aAAc,OACxB,CAAO,EACDJ,EAAS,UAAUJ,CAAK,GAE3B,EAAE,MAAOW,GAAQ,CACZ,QAAQ,IAAIA,CAAG,CACvB,CAAK,CACL,CAEA,SAASD,EAAcE,EAAK,CAC1B,OAAOA,EAAI,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IACtF;AAAA,sCACkCL,CAAa;AAAA,kBACjCD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,YAKhCC,CAAK;AAAA;AAAA;AAAA;AAAA,YAILC,CAAK;AAAA;AAAA;AAAA;AAAA,YAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,YAIRC,CAAS;AAAA;AAAA;AAAA,WAIrB,EAAI,KAAK,EAAE,CACX,CAEA,SAASd,EAAgBe,EAAS,CAChCA,EAAQ,QAASC,GAAU,CACrBA,EAAM,iBACR3B,GAAQ,EAENF,EAASC,EAAOC,CAAI,EAAE,KAAMe,GAAS,CACnCV,EAAQ,mBACJ,YACAW,EAAcD,EAAK,IAAI,CACrC,EAEUH,EAAS,QAAO,EAEZZ,EAAK,IAAMe,EAAK,YAClBD,EAAS,KAAK,CACV,SAAU,eACV,QAAS,6DACT,aAAc,OAC9B,CAAa,EACDJ,EAAS,UAAUJ,CAAK,EAEpC,CAAS,EAET,CAAG,CACH"}